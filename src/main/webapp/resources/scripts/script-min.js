!function(){"use strict";function e(e){return"-1"===e?!1:!0}function o(e,o){for(var s=Math.ceil(e/o),t=0,n=0;s>n;n++)for(var l=0;o>l&&t!==e;l++){var r="#pool"+(l+1);$(r).append('<div class="form-group pool-field"><div class="col-md-12"><input type="text" class="form-control contender-input" name="contender-'+(n+l)+'" id="contender-'+(n+l)+'"placeholder="Contender"></div></div>'),t++}}$(document).ready(function(){var s,t,n,l,r,a,c,p,d,i,f;s=window.location+"Load",t=$.ajax({type:"GET",async:!1,url:s,contentType:"application/json",success:function(e){for(l=$("#pool-select"),n=1;n<e.maxPools+1;n++)$(l).append("<option value="+n+">"+n+"</option>");return e},error:function(e,o,s){console.log(e),console.log(o),console.log(s)}}),$("#gender-select").change(function(){if($(this).parent().removeClass("has-error has-feedback"),$("#gender-error-text").remove(),a=$(this).val(),$("#weight-select").empty(),"-1"===a)$("#weight-select").append("<option value=-1>--</option>");else if("male"===a)for(n=0;n<t.responseJSON.maleWeightClasses.length;n++)$("#weight-select").append("<option value="+t.responseJSON.maleWeightClasses[n]+">"+t.responseJSON.maleWeightClasses[n]+" kg</option>");else if("female"===a)for(n=0;n<t.responseJSON.femaleWeightClasses.length;n++)$("#weight-select").append("<option value="+t.responseJSON.femaleWeightClasses[n]+">"+t.responseJSON.femaleWeightClasses[n]+" kg</option>")}),$("#pool-select").change(function(){if($(this).parent().removeClass("has-error has-feedback"),$("#pools-error-text").remove(),c=parseInt($("#contender-select").val()),i=$(this).val(),r=$("#contender-select"),r.empty(),r.append('<option value=-1 id="contender-option-0">--</option>'),"-1"==i)$("#pools-row").hide(),$("#pools-row").empty();else{for(n=2*i;n<t.responseJSON.maxContender+1;n++)$(r).append("<option value="+n+' id="contender-option-'+n+'">'+n+"</option>");1==i?($("#pools-row").empty(),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool1"><h3>Pool 1</h3></div>')):2==i?($("#pools-row").empty(),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool1"><h3>Pool 1</h3></div>'),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool2"><h3>Pool 2</h3></div>')):3==i?($("#pools-row").empty(),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool1"><h3>Pool 1</h3></div>'),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool2"><h3>Pool 2</h3></div>'),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool3"><h3>Pool 3</h3></div>')):(i=4)&&($("#pools-row").empty(),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool1"><h3>Pool 1</h3></div>'),$("#pools-row").append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool2"><h3>Pool 2</h3></div>'),$("#pools-row").last().append('<div class="col-xs-12 col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6 pool" id="pool3"><h3>Pool 3</h3></div>'),$("#pools-row").last().append('<div class="col-xs-12 col-sm-offset-2 col-sm-8  col-md-offset-3 col-md-6 pool" id="pool4"><h3>Pool 4</h3></div>')),o(c,i),-1===c&&(c=0),$("#contender-option-"+c).attr("selected","selected")}}),$("#contender-select").change(function(){i=$("#pool-select").val(),$(".pool-field").remove(),c=parseInt($(this).val()),-1!==c&&($(this).parent().removeClass("has-error has-feedback"),$("#contender-error-text").remove(),o(c,i))}),$("#submit-form").submit(function(o){if(p=$(this).serializeArray(),null===p[0].value||""===p[0].value)return $("#tournament-error-text").remove(),$("#tournament-name").parent().addClass("has-error has-feedback").append('<span class="glyphicon glyphicon-remove form-control-feedback"></span>'),$("#tournament-name").parent().append('<section class="row"><div class="col-xs-12 col-md-12" id="tournament-error-text"><h5>You must enter Tournament name</h5></div></section>'),!1;if(!e(p[1].value))return $("#gender-error-text").parent().remove(),$("#gender-select").parent().addClass("has-error has-feedback"),$("#gender-select").parent().append('<section class="row"><div class="col-xs-12 col-md-12" id="gender-error-text"><h5>You must enter a gender</h5></div>'),!1;if(!e(p[4].value))return $("#contender-error-text").parent().remove(),$("#contender-select").parent().addClass("has-error has-feedback"),$("#contender-select").parent().append('<section class="row"><div class="col-xs-12 col-md-12" id="contender-error-text"><h5>You must select how many contenders</h5></div>'),!1;for(var s=5;s<p.length;s++)if(null===p[s].value||""===p[s].value){$("#contender-error-text").parent().remove();var t=$("#contender-"+(s-5)),n='<section class="row"><div class="col-xs-12 col-md-12" id="input-error-text"><h5>You must enter a contender</h5></div></section>';return t.parent().addClass("has-error has-feedback"),t.parent().append(n),!1}var l=$("#pool-select").val();r=[];var a=5;for(s=0;l>s;s++){for(var c=$("#pool"+(s+1)+" input"),i=[],m=5;m<c.length+5;m++)i.push(p[a++].value);r.push(i)}var h=p[2].value,v=parseInt(h.substring(1,h.length));d={tournamentName:p[0].value,gender:p[1].value,weight:v,pools:parseInt(p[3].value),totalContenders:parseInt(p[4].value),contenders:r},$.ajax({type:"POST",async:!1,url:window.location+"Sort",contentType:"application/json;charset=UTF-8",data:JSON.stringify(d),dataType:"json",success:function(e){for($("form").toggle(),$("#info-tournament-name").append("<h4>"+e.tournamentName+"</h4>"),$("#info-gender").append("<h4>"+e.gender+"</h4>"),$("#info-weight").append("<h4>-"+e.weight+" kg</h4>"),$("#info-pools").append("<h4>"+e.pools+"</h4>"),$("#info-contenders").append("<h4>"+e.totalContenders+"</h4>"),$("#info-wrapper").toggle(),s=0;s<e.fighters.length;s++){var o=$("#pool"+(s+1)+"-fights");for(m=0;m<e.fighters[s].length;m++)f='<section class="row"><div class="col-xs-12"><h4>'+e.fighters[s][m].first+" - "+e.fighters[s][m].second+"</h4></div></section>",o.append(f);o.toggle()}},error:function(e,o,s){console.log(e),console.log(o),console.log(s)}}),console.log(JSON.stringify(d)),o.preventDefault()}),$("#tournament-name").on("focus",function(){$(this).parent().removeClass("has-error has-feedback"),$(this).parent().children().remove("span"),$("#tournament-error-text").remove()}),$("body").on("focus",".contender-input",function(){$(this).parent().removeClass("has-error has-feedback"),$(this).parent().children().remove("span"),$("#input-error-text").remove()})})}();